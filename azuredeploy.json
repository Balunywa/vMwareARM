{
    "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
    "contentVersion": "1.0.0.0",
    "parameters": {
        "VirtualMachineTemplateName": {
            "defaultValue": "WINDOWS-VM-AZURE-ARM",
            "type": "String"
        },
        "vCenterServerResourceId": {
            "defaultValue": "/subscriptions/c8bc39b5-8f1b-4d8e-92e3-35e2a5bb8c31/resourceGroups/Arc-vSphere-Home-vCenter-Server/providers/Microsoft.ConnectedVMwarevSphere/VCenters/Home-DC-01-vCenter-Server",
            "type": "String"
        },
        "customLocationResourceId": {
            "defaultValue": "/subscriptions/c8bc39b5-8f1b-4d8e-92e3-35e2a5bb8c31/resourcegroups/arc-vsphere-home-vcenter-server/providers/microsoft.extendedlocation/customlocations/azure-vcenter-resources",
            "type": "String"
        },
        "inventoryItemId": {
            "defaultValue": "vmtpl-vm-1071",
            "type": "String"
        },
        "moRefId": {
            "defaultValue": "vm-1071",
            "type": "String"
        },
        "hostId": {
            "type": "String",
            "defaultValue": "192.168.3.50"
        },
        "datastoreName": {
            "type": "String",
            "defaultValue": "datastore1"
        }
    },
    "variables": {},
    "resources": [
        {
            "type": "Microsoft.ConnectedVMwarevSphere/virtualMachines",
            "apiVersion": "2022-07-15-preview",
            "name": "[parameters('VirtualMachineTemplateName')]",
            "location": "eastus",
            "extendedLocation": {
                "type": "CustomLocation",
                "name": "[parameters('customLocationResourceId')]"
            },
            "properties": {
                "vCenterId": "[parameters('vCenterServerResourceId')]",
                "templateId": "[concat(parameters('vCenterServerResourceId'), '/VirtualMachineTemplates/', parameters('inventoryItemId'))]",
                "hostId": "[concat(parameters('vCenterServerResourceId'), '/hosts/', parameters('hostId'))]",
                "datastoreName": "[parameters('datastoreName')]",
                "moRefId": "[parameters('moRefId')]"
            }
        }
    ]
}
